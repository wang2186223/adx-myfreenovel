# 首页内容更新检测方案

## 📋 解决方案概述

为了让老用户能够发现新增的小说，我们实施了一个**轻量级、不干扰阅读历史**的内容检测机制。

## 🎯 核心设计理念

- ✅ **保护用户数据**：不清除浏览器缓存，保留阅读历史
- ✅ **温和提醒**：只在首页轻量提醒，不强制刷新
- ✅ **智能检测**：每6小时检查一次，避免频繁提醒
- ✅ **用户友好**：优雅的动画效果，3秒自动消失

## 🔧 技术实现

### 检测机制
1. **定时检查**：用户访问首页时，如果距离上次检查超过6小时，会自动检查新内容
2. **数量对比**：比较当前页面的小说数量与上次记录的数量
3. **本地存储**：使用 `localStorage` 记录检查时间和小说数量

### 通知方式
- **位置**：页面右上角固定位置
- **样式**：渐变背景，星形图标
- **行为**：3秒自动消失，或点击手动关闭
- **动画**：平滑的滑入/滑出效果

## 💾 存储的数据

该机制在浏览器中存储以下数据：

| 键名 | 描述 | 示例值 |
|------|------|--------|
| `lastContentCheck` | 上次检查时间戳 | `1726297200000` |
| `lastNovelCount` | 上次记录的小说数量 | `4` |
| `readingHistory` | 阅读历史（不受影响） | `[{"title": "..."}]` |

## 🎨 用户体验

### 首次访问
- 记录当前小说数量
- 不显示通知

### 再次访问（6小时内）
- 不进行检查
- 不显示通知

### 再次访问（6小时后）
- 检查小说数量变化
- 如有新增，显示"发现新小说！"通知

### 通知样式
```
┌─────────────────────────┐
│ ✨ 发现新小说！ ❌       │
└─────────────────────────┘
```

## 🚀 优势

1. **非侵入性**：不影响现有阅读历史功能
2. **性能友好**：只在首页运行，不影响章节页面加载
3. **自动化**：无需手动操作，智能检测
4. **可控性**：用户可以手动关闭通知

## 🔄 工作流程

```
用户访问首页
     ↓
检查是否超过6小时？
     ↓ 是
比较小说数量
     ↓ 发现新增
显示通知（3秒后消失）
     ↓
更新本地记录
```

## 📱 兼容性

- ✅ 支持所有现代浏览器
- ✅ 移动端友好
- ✅ 无JavaScript依赖冲突
- ✅ 不影响SEO

## 🎛️ 可调整参数

如需修改检测间隔，可在 `tools/templates/index.html` 中修改：

```javascript
// 当前：6小时 = 6 * 60 * 60 * 1000
// 改为1小时：1 * 60 * 60 * 1000
// 改为24小时：24 * 60 * 60 * 1000
```

---

*该方案已集成到首页模板中，下次生成网站时会自动应用。*
